{% extends "base.html" %}
{# Jinja2 Template - TEMPLATE_BASED Architecture #}

{% block title %}{{ page_title }} - My Site{% endblock %}

{% block content %}
<div class="container">
    {% if user.is_authenticated %}
        <h1>Welcome back, {{ user.name }}!</h1>
        
        {% for post in recent_posts %}
        <article class="post">
            <h2>{{ post.title }}</h2>
            <p class="meta">By {{ post.author }} on {{ post.date|date("F j, Y") }}</p>
            <p>{{ post.excerpt }}</p>
            <a href="{{ url_for('post', id=post.id) }}">Read more</a>
        </article>
        {% endfor %}
    {% else %}
        <h1>Please log in</h1>
        <form method="post" action="{{ url_for('login') }}">
            {{ form.csrf_token }}
            {{ form.username.label }}: {{ form.username }}
            {{ form.password.label }}: {{ form.password }}
            <button type="submit">Login</button>
        </form>
    {% endif %}
</div>
{% endblock %}

{% macro render_pagination(pagination) %}
<nav class="pagination">
    {% if pagination.has_prev %}
        <a href="?page={{ pagination.prev_num }}">Previous</a>
    {% endif %}
    
    {% for page in pagination.iter_pages() %}
        {% if page %}
            <a href="?page={{ page }}" {% if page == pagination.page %}class="active"{% endif %}>
                {{ page }}
            </a>
        {% endif %}
    {% endfor %}
    
    {% if pagination.has_next %}
        <a href="?page={{ pagination.next_num }}">Next</a>
    {% endif %}
</nav>
{% endmacro %}
